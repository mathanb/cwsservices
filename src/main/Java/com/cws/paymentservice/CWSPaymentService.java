package com.cws.paymentservice;

import javax.servlet.http.HttpServletRequest;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.MediaType;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.json.simple.JSONObject;

import com.cws.emailservice.CWSEmailService;
import com.cws.emailservice.Email;
import com.cws.emailservice.SendEmail;
import com.cws.util.CommonUtils;

/**
 * Restful webservice to send payments to Pin Payments provider.
 * 
 * @author Kevin
 *
 */
@Path("/cwspaymentservice;...................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................service")
public class CWSPaymentService {
private static final Logger logger = LogManager.getLogger(CWSEmailService.class);
	
	private final String SUCCESS_MSG = "Payment has been made successfully";
	private final String FAILED_MSG = "Payment failed";
	
	@Context
	private HttpServletRequest httpRequest;
	
	@GET
	@Path("/sendpayment/{amountToPay}/{description}/{nameOnCard}/{cardNumber}/{expiryMonth}/{expiryYear}/{cvc}/{email}/{addressLine1}/{addressLine2}/{city}/{state}/{postCode}/{country}")
	@Produces(MediaType.APPLICATION_JSON)
	public JSONObject sendPayment(@PathParam("amountToPay") String amountToPay, @PathParam("description") String description, 
			@PathParam("nameOnCard") String nameOnCard, @PathParam("cardNumber") String cardNumber, 
			@PathParam("expiryMonth") String expiryMonth,@PathParam("expiryYear") String expiryYear, @PathParam("cvc") String cvc, 
			@PathParam("email") String email,@PathParam("addressLine1") String addressLine1,
			@PathParam("addressLine2") String addressLine2, @PathParam("city") String city, @PathParam("state") String state, 
			@PathParam("postCode") String postCode, @PathParam("country") String country) {
		
		return sendPaymentPost(amountToPay, description, nameOnCard, cardNumber, expiryMonth, expiryYear, cvc,email, addressLine1, addressLine2, city, state, postCode, country);
	}
	
	@POST
	@Path("/sendpayment/{amountToPay}/{description}/{nameOnCard}/{cardNumber}/{expiryMonth}/{expiryYear}/{cvc}/{email}/{addressLine1}/{addressLine2}/{city}/{state}/{postCode}/{country}")
	@Produces(MediaType.APPLICATION_JSON)
	public JSONObject sendPaymentPost(@PathParam("amountToPay") String amountToPay, @PathParam("description") String description, 
			@PathParam("nameOnCard") String nameOnCard, @PathParam("cardNumber") String cardNumber, 
			@PathParam("expiryMonth") String expiryMonth,@PathParam("expiryYear") String expiryYear, @PathParam("cvc") String cvc,@PathParam("email") String email, @PathParam("addressLine1") String addressLine1,
			@PathParam("addressLine2") String addressLine2, @PathParam("city") String city, @PathParam("state") String state, 
			@PathParam("postCode") String postCode, @PathParam("country") String country) {

		final Payment payment = new Payment();
		payment.setAmountToPay(amountToPay);
		payment.setDescription(description);
		payment.setNameOnCard(nameOnCard);
		payment.setCardNumber(cardNumber);
		payment.setExpiryMonth(expiryMonth);
		payment.setExpiryYear(expiryYear);
		payment.setCvc(cvc);
		payment.setEmail(email);
		payment.setAddressLine1(addressLine1);
		payment.setAddressLine2(addressLine2);
		payment.setCity(city);
		payment.setState(state);
		payment.setPostCode(postCode);
		payment.setCountry(country);
		payment.setUserIpAddress(httpRequest.getRemoteAddr());
		
		final JSONObject obj = new JSONObject();
		try {
			SendPayment pay = new SendPayment();
			pay.sendPinPayments(payment);
			
			obj.put("result", SUCCESS_MSG);
		} catch (Exception e) {
			logger.error("Error in sendMailPost, error is: " + e.getMessage());
			obj.put("result", FAILED_MSG);
		}
		return obj;
	}
}
